#!/bin/bash

# respect XDG_CONFIG_HOME
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CONFIG_DIRS="/etc/xdg"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_DATA_DIRS="/usr/local/share/:/usr/share/"
export XDG_CACHE_HOME="$HOME/.cache"
#export XDG_RUNTIME_DIR="$HOME/$TMPDIR"

# prefer locally built packages
export PATH="$HOME/.built/bin:$PATH"

# prefer development binaries for go packages
export PATH="$HOME/dev/go/bin:$PATH"

# initialize shell with custom settings
source "$XDG_CONFIG_HOME/bash/system"
source "$XDG_CONFIG_HOME/bash/initcommands"
source "$XDG_CONFIG_HOME/bash/functions"
source "$XDG_CONFIG_HOME/bash/aliases"
source "$XDG_CONFIG_HOME/bash/prompt"

# ...and settings specific to zsh
if [ -n "$ZSH_VERSION" ]; then
  source "$XDG_CONFIG_HOME/zsh/compinstall"
  source "$XDG_CONFIG_HOME/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"
  source "$XDG_CONFIG_HOME/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh"

# ...and settings specific to bash
else
  bind -m vi-insert "\C-l":clear-screen
fi

# activate dircolors if installed
if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors && eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
fi

# use vi line-editing keybindings
set -o vi

# detect shellshock bug over ssh
export LC_SHOCKED="() { :;};echo \$'\\033[1;31mTHIS HOST IS SHELL SHOCKED\\033[0m'"

# remind user to set up system aliases
if [ -n "$SYSTEM_ALIASES_NOT_SET_UP" ]; then
  printf "system aliases not set up!\n"
fi
